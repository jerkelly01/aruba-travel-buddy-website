module.exports=[38716,a=>{"use strict";let b="http://localhost:5001/api";async function c(a,d={}){let e=localStorage.getItem("authToken");if(!e||"mock-token-for-demo"===e)return{success:!1,error:"Authentication required. Please log in.",details:{type:"AuthError",message:"No valid authentication token found. Please log in to access admin features."}};let f={"Content-Type":"application/json",...d.headers};e&&(f.Authorization=`Bearer ${e}`);try{let c,e=await fetch(`${b}${a}`,{...d,headers:f}),g=await e.text(),h=e.headers.get("content-type")||"",i=h.includes("application/json"),j=g.trim(),k=j.startsWith("<!DOCTYPE")||j.startsWith("<html")||j.startsWith("<!")||j.toLowerCase().startsWith("<body"),l=0===j.length;if(!k&&!l&&(j.startsWith("{")||j.startsWith("[")||j.startsWith('"'))&&!i&&!k&&!l){console.warn("Response looks like JSON but Content-Type is not set correctly. Attempting to parse...");try{let a=JSON.parse(g);if(!e.ok)return{success:!1,error:a.error||`Request failed: ${e.status} ${e.statusText}`,details:a.details};return a}catch(a){console.warn("Failed to parse as JSON despite looking like JSON:",a)}}if(!i||k||l){let c,f=e.status,j=e.statusText,m=`${b}${a}`,n=d.method||"GET",o=g.length,p=g.substring(0,500),q={};try{q=Object.fromEntries(e.headers.entries())}catch(a){q={error:"Could not read headers"}}console.error("=== Non-JSON Response Error ==="),console.error("Status:",f),console.error("Status Text:",j),console.error("Content-Type:",h||"(not set)"),console.error("URL:",m),console.error("Method:",n),console.error("Response Length:",o),console.error("Is Empty:",l),console.error("Looks Like HTML:",k),console.error("Is JSON:",i),console.error("Response Preview:",p),console.error("All Headers:",JSON.stringify(q,null,2)),console.error("Full Response Text:",g),console.error("=============================");let r={status:f,statusText:j,contentType:h||"(not set)",url:m,method:n,textLength:o,isEmpty:l,looksLikeHtml:k,isJson:i,preview:p,allHeaders:q};return c=l?`Backend server returned empty response (${f} ${j}). The endpoint may not be implemented or there's a server error. Check backend logs.`:k?`Backend server returned HTML instead of JSON (${f} ${j}). This usually means the backend server is not running or the endpoint doesn't exist. Make sure the backend server is running at ${b}`:`Backend server returned non-JSON response (${f} ${j}). Content-Type: ${h||"(not set)"}. Response preview: ${p.substring(0,100)}...`,{success:!1,error:c,details:r}}try{c=JSON.parse(g)}catch(c){return console.error("JSON parse error:",{error:c,status:e.status,statusText:e.statusText,contentType:h,url:`${b}${a}`,preview:g.substring(0,200)}),{success:!1,error:`Backend server returned invalid JSON. Make sure the backend server is running at ${b}`,details:{status:e.status,contentType:h,preview:g.substring(0,200),parseError:c instanceof Error?c.message:String(c)}}}if(!e.ok){if(401===e.status||403===e.status)return localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),{success:!1,error:c.error||"Authentication failed. Please log in again.",details:{...c.details,type:"AuthError",status:e.status,requiresLogin:!0}};return{success:!1,error:c.error||`Request failed: ${e.status} ${e.statusText}`,details:c.details}}return c}catch(c){if(console.error("=== API Request Failed (Catch Block) ==="),console.error("Error Type:",c instanceof Error?c.constructor.name:typeof c),console.error("Error Message:",c instanceof Error?c.message:String(c)),console.error("Error Stack:",c instanceof Error?c.stack:"N/A"),console.error("Endpoint:",`${b}${a}`),console.error("Options:",JSON.stringify(d,null,2)),console.error("========================================"),c instanceof TypeError&&(c.message.includes("fetch")||c.message.includes("Failed to fetch")))return{success:!1,error:`Cannot connect to backend server at ${b}. Make sure the backend server is running and accessible.`,details:{originalError:c.message,endpoint:`${b}${a}`,type:"NetworkError"}};if(c instanceof SyntaxError&&c.message.includes("JSON"))return{success:!1,error:`Backend server is not responding correctly. Make sure the backend server is running at ${b}`,details:{originalError:c.message,endpoint:`${b}${a}`,type:"ParseError"}};return{success:!1,error:c instanceof Error?c.message:"Unknown network error",details:{originalError:String(c),endpoint:`${b}${a}`,type:"UnknownError"}}}}function d(a){return{getAll:async b=>{let d=new URLSearchParams;b?.page&&d.append("page",b.page.toString()),b?.limit&&d.append("limit",b.limit.toString()),b?.category&&d.append("category",b.category),b?.featured&&d.append("featured","true"),b?.active!==void 0&&d.append("active",b.active.toString()),b?.search&&d.append("search",b.search);let e=d.toString();return c(`/admin/${a}${e?`?${e}`:""}`)},getById:async b=>c(`/admin/${a}/${b}`),create:async b=>c(`/admin/${a}`,{method:"POST",body:JSON.stringify(b)}),update:async(b,d)=>c(`/admin/${a}/${b}`,{method:"PUT",body:JSON.stringify(d)}),delete:async b=>c(`/admin/${a}/${b}`,{method:"DELETE"})}}let e=d("tours"),f=d("cultural-events"),g=d("local-experiences"),h=d("transportation"),i=d("support-locals"),j=d("restaurants"),k=d("photo-challenges");a.s(["clientProfileApi",0,{getClients:async a=>{let b=new URLSearchParams;a?.page&&b.append("page",a.page.toString()),a?.limit&&b.append("limit",a.limit.toString()),a?.status&&b.append("status",a.status),a?.category&&b.append("category",a.category),a?.featured&&b.append("featured","true"),a?.search&&b.append("search",a.search);let d=b.toString();return c(`/admin/clients${d?`?${d}`:""}`)},getClient:async a=>c(`/admin/clients/${a}`),createClient:async a=>c("/admin/clients",{method:"POST",body:JSON.stringify(a)}),updateClient:async(a,b)=>c(`/admin/clients/${a}`,{method:"PUT",body:JSON.stringify(b)}),deleteClient:async a=>c(`/admin/clients/${a}`,{method:"DELETE"}),getVersions:async a=>c(`/admin/clients/${a}/versions`)},"culturalEventsApi",0,f,"localExperiencesApi",0,g,"mapLocationsApi",0,{getAll:async a=>{let b=new URLSearchParams;a?.page&&b.append("page",a.page.toString()),a?.limit&&b.append("limit",a.limit.toString()),a?.category&&b.append("category",a.category),a?.featured&&b.append("featured","true"),a?.active!==void 0&&b.append("active",a.active.toString()),a?.search&&b.append("search",a.search);let d=b.toString();return c(`/admin/map-locations${d?`?${d}`:""}`)},getById:async a=>c(`/admin/map-locations/${a}`),create:async a=>c("/admin/map-locations",{method:"POST",body:JSON.stringify(a)}),update:async(a,b)=>c(`/admin/map-locations/${a}`,{method:"PUT",body:JSON.stringify(b)}),delete:async a=>c(`/admin/map-locations/${a}`,{method:"DELETE"})},"photoChallengesApi",0,k,"restaurantsApi",0,j,"supportLocalsApi",0,i,"toursApi",0,e,"transportationApi",0,h,"websiteAnalyticsApi",0,{getOverview:async a=>{let b=a?`?timeRange=${a}`:"";return c(`/admin/analytics/website/overview${b}`)},getTrafficMetrics:async a=>{let b=new URLSearchParams;a?.timeRange&&b.append("timeRange",a.timeRange),a?.groupBy&&b.append("groupBy",a.groupBy);let d=b.toString();return c(`/admin/analytics/website/traffic${d?`?${d}`:""}`)},getPopularPages:async a=>{let b=new URLSearchParams;a?.timeRange&&b.append("timeRange",a.timeRange),a?.limit&&b.append("limit",a.limit.toString());let d=b.toString();return c(`/admin/analytics/website/pages${d?`?${d}`:""}`)},getVisitorAnalytics:async a=>{let b=a?`?timeRange=${a}`:"";return c(`/admin/analytics/website/visitors${b}`)},getConversionFunnels:async a=>{let b=new URLSearchParams;a?.timeRange&&b.append("timeRange",a.timeRange),a?.conversionGoal&&b.append("conversionGoal",a.conversionGoal);let d=b.toString();return c(`/admin/analytics/website/conversions${d?`?${d}`:""}`)},exportAnalytics:async a=>{let b=new URLSearchParams;a?.format&&b.append("format",a.format),a?.timeRange&&b.append("timeRange",a.timeRange);let d=b.toString();return c(`/admin/analytics/website/export${d?`?${d}`:""}`)},trackEvent:async a=>c("/admin/analytics/website/track",{method:"POST",body:JSON.stringify(a)})}])},84899,a=>{"use strict";var b=a.i(97242),c=a.i(97924),d=a.i(26315),e=a.i(36380),f=a.i(12304),g=a.i(38716);function h(){let a=(0,d.useRouter)(),{user:h,isLoading:i,isAuthenticated:j}=(0,e.useAuth)(),[k,l]=(0,c.useState)("30d"),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(!0);(0,c.useEffect)(()=>{i||j||a.push("/login")},[i,j,a]),(0,c.useEffect)(()=>{j&&q()},[j,k]);let q=async()=>{p(!0);try{let a=await g.websiteAnalyticsApi.getOverview(k);a.success&&a.data&&n(a.data)}catch(a){console.error("Failed to fetch analytics:",a)}finally{p(!1)}};return i?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):j?(0,b.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,b.jsx)("div",{className:"bg-white shadow",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Website Analytics"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Track website performance and visitor behavior"})]}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(f.default,{href:"/admin",className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:"Dashboard"}),(0,b.jsxs)("select",{value:k,onChange:a=>l(a.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--brand-aruba)]",children:[(0,b.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,b.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,b.jsx)("option",{value:"90d",children:"Last 90 days"})]})]})]})})}),(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"text-gray-600",children:"Loading analytics..."})}):m?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Total Visitors"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:m.totalVisitors?.toLocaleString()||0}),(0,b.jsxs)("div",{className:"text-green-600 text-sm mt-2",children:[k," period"]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Page Views"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:m.totalPageViews?.toLocaleString()||0}),(0,b.jsxs)("div",{className:"text-gray-600 text-sm mt-2",children:[m.totalVisitors>0?Math.round(m.totalPageViews/m.totalVisitors):0," ","pages per visitor"]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Bounce Rate"}),(0,b.jsxs)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:[m.bounceRate?.toFixed(1)||0,"%"]}),(0,b.jsx)("div",{className:"text-gray-600 text-sm mt-2",children:m.bounceRate<40?"Excellent":m.bounceRate<60?"Good":"Needs improvement"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Avg Session Duration"}),(0,b.jsxs)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:[m.avgSessionDuration?Math.round(m.avgSessionDuration/60):0,"m"]}),(0,b.jsx)("div",{className:"text-gray-600 text-sm mt-2",children:m.avgSessionDuration?`${m.avgSessionDuration%60}s`:"0s"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"New Visitors"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-[var(--brand-aruba)]",children:m.newVisitors?.toLocaleString()||0}),(0,b.jsxs)("div",{className:"text-sm text-gray-600 mt-2",children:[m.totalVisitors>0?Math.round(m.newVisitors/m.totalVisitors*100):0,"% of total visitors"]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Returning Visitors"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-[var(--brand-amber)]",children:(m.totalVisitors-m.newVisitors)?.toLocaleString()||0}),(0,b.jsxs)("div",{className:"text-sm text-gray-600 mt-2",children:[m.totalVisitors>0?Math.round((m.totalVisitors-m.newVisitors)/m.totalVisitors*100):0,"% of total visitors"]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Traffic Over Time"}),(0,b.jsx)("p",{className:"text-gray-600 text-sm",children:"Charts will be implemented with Chart.js or Recharts library"}),(0,b.jsx)("div",{className:"mt-4 h-64 bg-gray-100 rounded flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-gray-500",children:"Chart visualization coming soon"})})]})]}):(0,b.jsx)("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:(0,b.jsx)("p",{className:"text-gray-600",children:"No analytics data available"})})})]}):null}a.s(["default",()=>h])}];

//# sourceMappingURL=aruba-travel-buddy-website_src_17166560._.js.map