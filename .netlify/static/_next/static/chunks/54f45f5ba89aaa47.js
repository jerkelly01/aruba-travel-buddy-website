(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,45364,e=>{"use strict";let t="http://localhost:5001/api";async function a(e,s={}){let r=localStorage.getItem("authToken");if(!r||"mock-token-for-demo"===r)return{success:!1,error:"Authentication required. Please log in.",details:{type:"AuthError",message:"No valid authentication token found. Please log in to access admin features."}};let n={"Content-Type":"application/json",...s.headers};r&&(n.Authorization=`Bearer ${r}`);try{let a,r=await fetch(`${t}${e}`,{...s,headers:n}),i=await r.text(),o=r.headers.get("content-type")||"",l=o.includes("application/json"),d=i.trim(),c=d.startsWith("<!DOCTYPE")||d.startsWith("<html")||d.startsWith("<!")||d.toLowerCase().startsWith("<body"),m=0===d.length;if(!c&&!m&&(d.startsWith("{")||d.startsWith("[")||d.startsWith('"'))&&!l&&!c&&!m){console.warn("Response looks like JSON but Content-Type is not set correctly. Attempting to parse...");try{let e=JSON.parse(i);if(!r.ok)return{success:!1,error:e.error||`Request failed: ${r.status} ${r.statusText}`,details:e.details};return e}catch(e){console.warn("Failed to parse as JSON despite looking like JSON:",e)}}if(!l||c||m){let a,n=r.status,d=r.statusText,g=`${t}${e}`,h=s.method||"GET",x=i.length,p=i.substring(0,500),u={};try{u=Object.fromEntries(r.headers.entries())}catch(e){u={error:"Could not read headers"}}console.error("=== Non-JSON Response Error ==="),console.error("Status:",n),console.error("Status Text:",d),console.error("Content-Type:",o||"(not set)"),console.error("URL:",g),console.error("Method:",h),console.error("Response Length:",x),console.error("Is Empty:",m),console.error("Looks Like HTML:",c),console.error("Is JSON:",l),console.error("Response Preview:",p),console.error("All Headers:",JSON.stringify(u,null,2)),console.error("Full Response Text:",i),console.error("=============================");let y={status:n,statusText:d,contentType:o||"(not set)",url:g,method:h,textLength:x,isEmpty:m,looksLikeHtml:c,isJson:l,preview:p,allHeaders:u};return a=m?`Backend server returned empty response (${n} ${d}). The endpoint may not be implemented or there's a server error. Check backend logs.`:c?`Backend server returned HTML instead of JSON (${n} ${d}). This usually means the backend server is not running or the endpoint doesn't exist. Make sure the backend server is running at ${t}`:`Backend server returned non-JSON response (${n} ${d}). Content-Type: ${o||"(not set)"}. Response preview: ${p.substring(0,100)}...`,{success:!1,error:a,details:y}}try{a=JSON.parse(i)}catch(a){return console.error("JSON parse error:",{error:a,status:r.status,statusText:r.statusText,contentType:o,url:`${t}${e}`,preview:i.substring(0,200)}),{success:!1,error:`Backend server returned invalid JSON. Make sure the backend server is running at ${t}`,details:{status:r.status,contentType:o,preview:i.substring(0,200),parseError:a instanceof Error?a.message:String(a)}}}if(!r.ok){if(401===r.status||403===r.status)return localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),{success:!1,error:a.error||"Authentication failed. Please log in again.",details:{...a.details,type:"AuthError",status:r.status,requiresLogin:!0}};return{success:!1,error:a.error||`Request failed: ${r.status} ${r.statusText}`,details:a.details}}return a}catch(a){if(console.error("=== API Request Failed (Catch Block) ==="),console.error("Error Type:",a instanceof Error?a.constructor.name:typeof a),console.error("Error Message:",a instanceof Error?a.message:String(a)),console.error("Error Stack:",a instanceof Error?a.stack:"N/A"),console.error("Endpoint:",`${t}${e}`),console.error("Options:",JSON.stringify(s,null,2)),console.error("========================================"),a instanceof TypeError&&(a.message.includes("fetch")||a.message.includes("Failed to fetch")))return{success:!1,error:`Cannot connect to backend server at ${t}. Make sure the backend server is running and accessible.`,details:{originalError:a.message,endpoint:`${t}${e}`,type:"NetworkError"}};if(a instanceof SyntaxError&&a.message.includes("JSON"))return{success:!1,error:`Backend server is not responding correctly. Make sure the backend server is running at ${t}`,details:{originalError:a.message,endpoint:`${t}${e}`,type:"ParseError"}};return{success:!1,error:a instanceof Error?a.message:"Unknown network error",details:{originalError:String(a),endpoint:`${t}${e}`,type:"UnknownError"}}}}function s(e){return{getAll:async t=>{let s=new URLSearchParams;t?.page&&s.append("page",t.page.toString()),t?.limit&&s.append("limit",t.limit.toString()),t?.category&&s.append("category",t.category),t?.featured&&s.append("featured","true"),t?.active!==void 0&&s.append("active",t.active.toString()),t?.search&&s.append("search",t.search);let r=s.toString();return a(`/admin/${e}${r?`?${r}`:""}`)},getById:async t=>a(`/admin/${e}/${t}`),create:async t=>a(`/admin/${e}`,{method:"POST",body:JSON.stringify(t)}),update:async(t,s)=>a(`/admin/${e}/${t}`,{method:"PUT",body:JSON.stringify(s)}),delete:async t=>a(`/admin/${e}/${t}`,{method:"DELETE"})}}let r=s("tours"),n=s("cultural-events"),i=s("local-experiences"),o=s("transportation"),l=s("support-locals"),d=s("restaurants"),c=s("photo-challenges");e.s(["clientProfileApi",0,{getClients:async e=>{let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.limit&&t.append("limit",e.limit.toString()),e?.status&&t.append("status",e.status),e?.category&&t.append("category",e.category),e?.featured&&t.append("featured","true"),e?.search&&t.append("search",e.search);let s=t.toString();return a(`/admin/clients${s?`?${s}`:""}`)},getClient:async e=>a(`/admin/clients/${e}`),createClient:async e=>a("/admin/clients",{method:"POST",body:JSON.stringify(e)}),updateClient:async(e,t)=>a(`/admin/clients/${e}`,{method:"PUT",body:JSON.stringify(t)}),deleteClient:async e=>a(`/admin/clients/${e}`,{method:"DELETE"}),getVersions:async e=>a(`/admin/clients/${e}/versions`)},"culturalEventsApi",0,n,"localExperiencesApi",0,i,"mapLocationsApi",0,{getAll:async e=>{let t=new URLSearchParams;e?.page&&t.append("page",e.page.toString()),e?.limit&&t.append("limit",e.limit.toString()),e?.category&&t.append("category",e.category),e?.featured&&t.append("featured","true"),e?.active!==void 0&&t.append("active",e.active.toString()),e?.search&&t.append("search",e.search);let s=t.toString();return a(`/admin/map-locations${s?`?${s}`:""}`)},getById:async e=>a(`/admin/map-locations/${e}`),create:async e=>a("/admin/map-locations",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>a(`/admin/map-locations/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>a(`/admin/map-locations/${e}`,{method:"DELETE"})},"photoChallengesApi",0,c,"restaurantsApi",0,d,"supportLocalsApi",0,l,"toursApi",0,r,"transportationApi",0,o,"websiteAnalyticsApi",0,{getOverview:async e=>{let t=e?`?timeRange=${e}`:"";return a(`/admin/analytics/website/overview${t}`)},getTrafficMetrics:async e=>{let t=new URLSearchParams;e?.timeRange&&t.append("timeRange",e.timeRange),e?.groupBy&&t.append("groupBy",e.groupBy);let s=t.toString();return a(`/admin/analytics/website/traffic${s?`?${s}`:""}`)},getPopularPages:async e=>{let t=new URLSearchParams;e?.timeRange&&t.append("timeRange",e.timeRange),e?.limit&&t.append("limit",e.limit.toString());let s=t.toString();return a(`/admin/analytics/website/pages${s?`?${s}`:""}`)},getVisitorAnalytics:async e=>{let t=e?`?timeRange=${e}`:"";return a(`/admin/analytics/website/visitors${t}`)},getConversionFunnels:async e=>{let t=new URLSearchParams;e?.timeRange&&t.append("timeRange",e.timeRange),e?.conversionGoal&&t.append("conversionGoal",e.conversionGoal);let s=t.toString();return a(`/admin/analytics/website/conversions${s?`?${s}`:""}`)},exportAnalytics:async e=>{let t=new URLSearchParams;e?.format&&t.append("format",e.format),e?.timeRange&&t.append("timeRange",e.timeRange);let s=t.toString();return a(`/admin/analytics/website/export${s?`?${s}`:""}`)},trackEvent:async e=>a("/admin/analytics/website/track",{method:"POST",body:JSON.stringify(e)})}])},50938,e=>{"use strict";var t=e.i(24638),a=e.i(49659),s=e.i(3301),r=e.i(43447),n=e.i(52961),i=e.i(45364);function o(){let e=(0,s.useRouter)(),{user:o,isLoading:l,logout:d,isAuthenticated:c}=(0,r.useAuth)(),[m,g]=(0,a.useState)(null),[h,x]=(0,a.useState)(!0);(0,a.useEffect)(()=>{l||c||e.push("/login")},[l,c,e]),(0,a.useEffect)(()=>{c&&p()},[c]);let p=async()=>{x(!0);try{let e=await i.websiteAnalyticsApi.getOverview("30d"),[t,a,s,r,n,o]=await Promise.all([i.toursApi.getAll({limit:1}),i.culturalEventsApi.getAll({limit:1}),i.localExperiencesApi.getAll({limit:1}),i.restaurantsApi.getAll({limit:1}),i.mapLocationsApi.getAll({limit:1}),i.clientProfileApi.getClients({limit:1})]),l=e.success?e.data:null;g({totalVisitors:l?.totalVisitors||0,totalPageViews:l?.totalPageViews||0,bounceRate:l?.bounceRate||0,avgSessionDuration:l?.avgSessionDuration||0,totalTours:t.success&&t.data?.pagination?t.data.pagination.total:0,totalEvents:a.success&&a.data?.pagination?a.data.pagination.total:0,totalExperiences:s.success&&s.data?.pagination?s.data.pagination.total:0,totalRestaurants:r.success&&r.data?.pagination?r.data.pagination.total:0,totalLocations:n.success&&n.data?.pagination?n.data.pagination.total:0,totalClients:o.success&&o.data?.pagination?o.data.pagination.total:0})}catch(e){console.error("Failed to fetch dashboard stats:",e),g({totalVisitors:0,totalPageViews:0,bounceRate:0,avgSessionDuration:0,totalTours:0,totalEvents:0,totalExperiences:0,totalRestaurants:0,totalLocations:0,totalClients:0})}finally{x(!1)}};return l?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):c?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,t.jsx)("div",{className:"bg-white shadow",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Welcome, ",o?.name]})]}),(0,t.jsx)("button",{onClick:()=>{d(),e.push("/")},className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Logout"})]})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[(0,t.jsxs)(n.default,{href:"/admin/clients",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Client Management"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Create and manage client profiles displayed in the app"}),(0,t.jsx)("span",{className:"text-[var(--brand-aruba)] font-semibold",children:"Manage Clients →"})]}),(0,t.jsxs)(n.default,{href:"/admin/analytics",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Website Analytics"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Track website performance, visitors, and conversions"}),(0,t.jsx)("span",{className:"text-[var(--brand-aruba)] font-semibold",children:"View Analytics →"})]}),(0,t.jsxs)(n.default,{href:"/admin/tours",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Tours"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Manage tour packages and activities"}),(0,t.jsx)("span",{className:"text-[var(--brand-aruba)] font-semibold",children:"Manage Tours →"})]}),(0,t.jsxs)(n.default,{href:"/admin/cultural-events",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Cultural Events"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Manage cultural events and festivals"}),(0,t.jsx)("span",{className:"text-[var(--brand-aruba)] font-semibold",children:"Manage Events →"})]}),(0,t.jsxs)(n.default,{href:"/admin/local-experiences",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Local Experiences"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Manage local experiences and activities"}),(0,t.jsx)("span",{className:"text-[var(--brand-aruba)] font-semibold",children:"Manage Experiences →"})]}),(0,t.jsxs)(n.default,{href:"/admin/transportation",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Transportation"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Manage car rentals and transportation options"}),(0,t.jsx)("span",{className:"text-[var(--brand-aruba)] font-semibold",children:"Manage Transportation →"})]}),(0,t.jsxs)(n.default,{href:"/admin/support-locals",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Support Locals"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Manage local businesses and initiatives"}),(0,t.jsx)("span",{className:"text-[var(--brand-aruba)] font-semibold",children:"Manage Locals →"})]}),(0,t.jsxs)(n.default,{href:"/admin/restaurants",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Restaurants"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Manage restaurant listings and information"}),(0,t.jsx)("span",{className:"text-[var(--brand-aruba)] font-semibold",children:"Manage Restaurants →"})]}),(0,t.jsxs)(n.default,{href:"/admin/photo-challenges",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Photo Challenges"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Manage user photo challenge prompts"}),(0,t.jsx)("span",{className:"text-[var(--brand-aruba)] font-semibold",children:"Manage Challenges →"})]}),(0,t.jsxs)(n.default,{href:"/admin/map-locations",className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Map Locations"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Manage locations for the explore map (beaches, spots, etc.)"}),(0,t.jsx)("span",{className:"text-[var(--brand-aruba)] font-semibold",children:"Manage Map Locations →"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Loading..."}),(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:"-"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Loading..."}),(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:"-"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Loading..."}),(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:"-"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Loading..."}),(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:"-"})]})]}):m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Website Visitors"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:m.totalVisitors.toLocaleString()}),(0,t.jsx)("div",{className:"text-gray-600 text-sm mt-2",children:"Last 30 days"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Page Views"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:m.totalPageViews.toLocaleString()}),(0,t.jsx)("div",{className:"text-gray-600 text-sm mt-2",children:"Last 30 days"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Bounce Rate"}),(0,t.jsxs)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:[m.bounceRate.toFixed(1),"%"]}),(0,t.jsx)("div",{className:"text-gray-600 text-sm mt-2",children:m.bounceRate<40?"Excellent":m.bounceRate<60?"Good":"Needs improvement"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("div",{className:"text-gray-600 text-sm font-medium",children:"Avg Session"}),(0,t.jsxs)("div",{className:"text-3xl font-bold text-gray-900 mt-2",children:[Math.round(m.avgSessionDuration/60),"m"]}),(0,t.jsxs)("div",{className:"text-gray-600 text-sm mt-2",children:[m.avgSessionDuration%60,"s average"]})]})]}):null}),m&&(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-gray-600 text-xs font-medium",children:"Tours"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:m.totalTours})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-gray-600 text-xs font-medium",children:"Events"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:m.totalEvents})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-gray-600 text-xs font-medium",children:"Experiences"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:m.totalExperiences})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-gray-600 text-xs font-medium",children:"Restaurants"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:m.totalRestaurants})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-gray-600 text-xs font-medium",children:"Map Locations"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:m.totalLocations})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("div",{className:"text-gray-600 text-xs font-medium",children:"Clients"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:m.totalClients})]})]})]})]}):null}e.s(["default",()=>o])}]);